<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>منصة كلية المحاسبة غريان</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- المتغيرات والتنسيقات الأساسية --- */
        :root {
            --primary-gradient: linear-gradient(135deg, #003366, #2c97de);
            --secondary-color: #d4af37; /* ذهبي */
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: 1px solid rgba(255, 255, 255, 0.4);
            --text-dark: #1a252f;
            --sidebar-glass: rgba(15, 23, 42, 0.95);
            --header-glass: rgba(0, 51, 102, 0.9);
            --active-item-glass: rgba(44, 151, 222, 0.4);
        }

        * { box-sizing: border-box; scroll-behavior: smooth; }
        body {
            font-family: 'Cairo', sans-serif; margin: 0; padding: 0;
            color: var(--text-dark); overflow-x: hidden;
            background: #0f2027; min-height: 100vh;
        }

        /* --- الخلفية المتحركة --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
            background: linear-gradient(to bottom right, #0f2027, #203a43, #2c5364); overflow: hidden;
        }
        .bg-orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.5; z-index: -1; }
        .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: rgba(44, 151, 222, 0.6); animation: moveOrb1 25s infinite alternate ease-in-out; }
        .orb-2 { bottom: -20%; right: -20%; width: 60vw; height: 60vw; background: rgba(0, 51, 102, 0.7); animation: moveOrb2 30s infinite alternate-reverse ease-in-out; }
        @keyframes moveOrb1 { from { transform: translate(0, 0); } to { transform: translate(20%, 30%); } }
        @keyframes moveOrb2 { from { transform: translate(0, 0); } to { transform: translate(-30%, -20%); } }

        /* كلاسات مساعدة */
        .hidden { display: none !important; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }
        .glass-effect {
            background: var(--glass-bg); backdrop-filter: blur(12px);
            border: var(--glass-border); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .btn { cursor: pointer; border: none; outline: none; transition: all 0.3s ease; font-family: 'Cairo', sans-serif; }
        .section-title {
            color: white; margin: 40px 0 20px; font-size: 1.5rem; border-right: 5px solid var(--secondary-color);
            padding-right: 15px; text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        /* --- الهيدر والبحث --- */
        .main-header {
            background: var(--header-glass); backdrop-filter: blur(15px); color: white;
            padding: 10px 0; box-shadow: 0 4px 25px rgba(0,0,0,0.25);
            position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        .header-content { display: flex; align-items: center; justify-content: space-between; }
        .brand-area { display: flex; align-items: center; gap: 15px; cursor: pointer; }
        .uni-logo-img { width: 50px; height: 50px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .brand-text h1 { margin: 0; font-size: 1.3rem; font-weight: 800; }
        .brand-text small { display: block; font-size: 0.85rem; color: var(--secondary-color); font-weight: 600; }
        
        .search-container { position: relative; }
        .search-bar-glass {
            background: rgba(255,255,255,0.15); border-radius: 30px; padding: 8px 15px;
            display: flex; align-items: center; gap: 10px; border: 1px solid rgba(255,255,255,0.3); width: 250px;
        }
        .search-bar-glass input {
            background: transparent; border: none; color: white; outline: none;
            font-family: 'Cairo'; font-size: 0.9rem; width: 100%;
        }
        .search-suggestions {
            position: absolute; top: 110%; left: 0; width: 100%;
            background: white; border-radius: 12px; padding: 5px 0; list-style: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: none; z-index: 200;
        }
        .search-suggestions.show { display: block; }
        .suggestion-item { padding: 10px 15px; color: #333; cursor: pointer; border-bottom: 1px solid #eee; }
        .suggestion-item:hover { background: #f0f2f5; color: var(--primary-color); }

        /* --- 1. شبكة المواد العامة (General Subjects) --- */
        .general-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px;
        }
        .subject-chip {
            background: rgba(255, 255, 255, 0.9); border-radius: 12px; padding: 15px;
            text-align: center; cursor: pointer; transition: 0.3s; border: 1px solid transparent;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 120px;
        }
        .subject-chip:hover {
            transform: translateY(-5px); background: white; border-color: var(--secondary-color);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .subject-icon { font-size: 2rem; color: #003366; margin-bottom: 10px; }
        .subject-name { font-weight: 700; font-size: 0.9rem; color: #333; line-height: 1.2; }

        /* --- 2. شبكة الأقسام (Departments) --- */
        .departments-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px;
        }
        .dept-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            border-radius: 20px; padding: 30px; text-align: center; cursor: pointer; transition: 0.4s;
            border: 1px solid rgba(255,255,255,0.5); position: relative; overflow: hidden;
        }
        .dept-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: var(--secondary-color);
        }
        .dept-card:hover { transform: scale(1.03); box-shadow: 0 15px 30px rgba(0,0,0,0.2); }
        .dept-icon { font-size: 3rem; color: var(--secondary-color); margin-bottom: 15px; text-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .dept-title { font-size: 1.4rem; font-weight: 800; color: #003366; margin: 0; }

        /* --- 3. قائمة كورسات القسم (داخل القسم) --- */
        .courses-list-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .course-card-inner {
            background: white; border-radius: 15px; padding: 20px; cursor: pointer; transition: 0.3s;
            border-left: 5px solid #003366;
        }
        .course-card-inner:hover { transform: translateX(-5px); background: #f9f9f9; }

        /* --- 4. المشغل (Viewer) --- */
        .viewer-layout { display: flex; height: calc(100vh - 80px); margin-top: 20px; overflow: hidden; }
        .viewer-sidebar { width: 350px; background: var(--sidebar-glass); backdrop-filter: blur(15px); color: #fff; display: flex; flex-direction: column; border-radius: 16px; margin-left: 20px; }
        .sidebar-header { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .playlist-container { flex: 1; overflow-y: auto; }
        .playlist-item { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; display: flex; justify-content: space-between; }
        .playlist-item.active { background: var(--active-item-glass); border-right: 4px solid var(--secondary-color); }
        
        .viewer-content { flex: 1; overflow-y: auto; padding: 0 0 20px 20px; }
        .video-container { position: relative; padding-bottom: 56.25%; background: #000; border-radius: 16px; overflow: hidden; margin-bottom: 20px; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        @media (max-width: 900px) {
            .viewer-layout { flex-direction: column; height: auto; }
            .viewer-sidebar { width: 100%; margin: 0 0 20px 0; max-height: 400px; }
            .viewer-content { padding: 0; }
        }
    </style>
</head>
<body>

    <div class="bg-animation">
        <div class="bg-orb orb-1"></div>
        <div class="bg-orb orb-2"></div>
    </div>

    <header class="main-header">
        <div class="container header-content">
            <div class="brand-area" onclick="goHome()">
                <img src="https://cdn-icons-png.flaticon.com/512/2231/2231648.png" alt="شعار" class="uni-logo-img">
                <div class="brand-text">
                    <h1>كلية المحاسبة غريان</h1>
                    <small>المنصة التعليمية</small>
                </div>
            </div>
            <div class="search-container">
                <div class="search-bar-glass">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="بحث شامل..." autocomplete="off">
                </div>
                <ul class="search-suggestions" id="suggestionBox"></ul>
            </div>
        </div>
    </header>

    <div id="homeView" class="container">
        
        <h2 class="section-title"><i class="fas fa-book-open"></i> المواد العامة (المتطلبات)</h2>
        <div class="general-grid" id="generalGrid">
            </div>

        <h2 class="section-title"><i class="fas fa-university"></i> الأقسام التخصصية</h2>
        <div class="departments-grid" id="departmentsGrid">
            </div>
    </div>

    <div id="deptView" class="container hidden">
        <button onclick="goHome()" class="btn" style="color: white; margin: 20px 0; font-size: 1.1rem;">
            <i class="fas fa-arrow-right"></i> عودة للرئيسية
        </button>
        <h2 id="deptTitleDisplay" style="color: white; font-size: 2rem; margin-bottom: 30px;"></h2>
        <div class="courses-list-grid" id="deptCoursesGrid"></div>
    </div>

    <div id="playerView" class="container hidden">
        <div class="viewer-layout">
            <div class="viewer-sidebar">
                <div class="sidebar-header">
                    <button onclick="goBackFromPlayer()" class="btn" style="color: #ccc; background: transparent;">
                        <i class="fas fa-arrow-right"></i> عودة للخلف
                    </button>
                    <h3 id="playerCourseTitle" style="margin: 10px 0; color: var(--secondary-color);">اسم المادة</h3>
                </div>
                <div class="playlist-container" id="playlistItems"></div>
            </div>

            <div class="viewer-content">
                <div class="video-container">
                    <iframe id="mainVideoPlayer" src="" frameborder="0" allowfullscreen></iframe>
                </div>
                <div class="glass-effect" style="padding: 30px; border-radius: 16px;">
                    <h2 id="currentLessonTitle" style="color: #003366; margin-top: 0;">عنوان الحلقة</h2>
                    <p id="currentLessonSummary" style="color: #444; line-height: 1.8;">الوصف...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // 1. قاعدة البيانات (Data Structure)
        // ============================================

        // أ) المواد العامة (18 مادة)
        const generalSubjects = [
            { id: 'g1', title: "لغة عربية", icon: "fa-language", videos: [{title: "أساسيات النحو", id: "VIDEO_ID", summary: "شرح للمبتدأ والخبر"}] },
            { id: 'g2', title: "دراسات اسلامية", icon: "fa-quran", videos: [{title: "فقه المعاملات", id: "VIDEO_ID", summary: "مقدمة في الفقه"}] },
            { id: 'g3', title: "قانون مدني", icon: "fa-balance-scale", videos: [{title: "مصادر الالتزام", id: "VIDEO_ID", summary: "شرح القانون المدني"}] },
            { id: 'g4', title: "لغة انجليزية 1", icon: "fa-font", videos: [{title: "Grammar Basics", id: "VIDEO_ID", summary: "Verb to be"}] },
            { id: 'g5', title: "لغة انجليزية 2", icon: "fa-font", videos: [{title: "Advanced Grammar", id: "VIDEO_ID", summary: "Tenses"}] },
            { id: 'g6', title: "مبادئ اقتصاد 1", icon: "fa-chart-line", videos: [{title: "العرض والطلب", id: "VIDEO_ID", summary: "مقدمة الاقتصاد الجزئي"}] },
            { id: 'g7', title: "مبادئ اقتصاد 2", icon: "fa-chart-pie", videos: [{title: "الدخل القومي", id: "VIDEO_ID", summary: "مقدمة الاقتصاد الكلي"}] },
            { id: 'g8', title: "مبادئ ادارة 1", icon: "fa-briefcase", videos: [{title: "وظائف الإدارة", id: "VIDEO_ID", summary: "التخطيط والتنظيم"}] },
            { id: 'g9', title: "مبادئ ادارة 2", icon: "fa-sitemap", videos: [{title: "السلوك التنظيمي", id: "VIDEO_ID", summary: "القيادة والتحفيز"}] },
            { id: 'g10', title: "مبادئ محاسبة 1", icon: "fa-calculator", videos: [{title: "معادلة الميزانية", id: "VIDEO_ID", summary: "الأصول والخصوم"}] },
            { id: 'g11', title: "مبادئ محاسبة 2", icon: "fa-file-invoice-dollar", videos: [{title: "التسويات الجردية", id: "VIDEO_ID", summary: "إهلاك الأصول"}] },
            { id: 'g12', title: "مبادئ احصاء 1", icon: "fa-sort-numeric-up", videos: [{title: "مقاييس النزعة المركزية", id: "VIDEO_ID", summary: "الوسط والوسيط"}] },
            { id: 'g13', title: "مبادئ احصاء 2", icon: "fa-chart-bar", videos: [{title: "الاحتمالات", id: "VIDEO_ID", summary: "نظرية الاحتمالات"}] },
            { id: 'g14', title: "تحليل رياضي 1", icon: "fa-infinity", videos: [{title: "التفاضل", id: "VIDEO_ID", summary: "قواعد الاشتقاق"}] },
            { id: 'g15', title: "تحليل رياضي 2", icon: "fa-square-root-alt", videos: [{title: "التكامل", id: "VIDEO_ID", summary: "تطبيقات التكامل"}] },
            { id: 'g16', title: "مبادئ حاسوب", icon: "fa-laptop-code", videos: [{title: "مكونات الحاسوب", id: "VIDEO_ID", summary: "Hardwar & Software"}] },
            { id: 'g17', title: "مبادئ تمويل", icon: "fa-money-bill-wave", videos: [{title: "القيمة الزمنية للنقود", id: "VIDEO_ID", summary: "الفائدة المركبة"}] },
            { id: 'g18', title: "مبادئ الاستثمار", icon: "fa-hand-holding-usd", videos: [{title: "المحافظ الاستثمارية", id: "VIDEO_ID", summary: "العائد والمخاطرة"}] }
        ];

        // ب) الأقسام والكورسات (5 أقسام)
        const departments = [
            {
                id: 'dept_acc', name: 'قسم المحاسبة', icon: 'fa-calculator', 
                courses: [
                    { id: 'c_acc1', title: 'محاسبة متوسطة 1', videos: [{title:'المخزون', id:'vid1', summary:'طرق تقييم المخزون'}] },
                    { id: 'c_acc2', title: 'محاسبة ضريبية', videos: [{title:'ضريبة الدخل', id:'vid2', summary:'وعاء الضريبة'}] }
                ]
            },
            {
                id: 'dept_data', name: 'قسم تحليل بيانات', icon: 'fa-database',
                courses: [
                    { id: 'c_da1', title: 'تحليل البيانات بـ Excel', videos: [{title:'Pivot Tables', id:'vid3', summary:'الجداول المحورية'}] },
                    { id: 'c_da2', title: 'Python for Finance', videos: [{title:'Pandas Library', id:'vid4', summary:'مكتبة بانداس'}] }
                ]
            },
            {
                id: 'dept_admin', name: 'قسم إدارة الأعمال', icon: 'fa-user-tie',
                courses: [
                    { id: 'c_adm1', title: 'إدارة الموارد البشرية', videos: [{title:'التوظيف', id:'vid5', summary:'استراتيجيات التوظيف'}] }
                ]
            },
            {
                id: 'dept_eco', name: 'قسم الاقتصاد', icon: 'fa-globe-africa',
                courses: [
                    { id: 'c_eco1', title: 'اقتصاد دولي', videos: [{title:'التجارة الخارجية', id:'vid6', summary:'النظريات التجارية'}] }
                ]
            },
            {
                id: 'dept_fin', name: 'قسم التمويل', icon: 'fa-coins',
                courses: [
                    { id: 'c_fin1', title: 'أسواق مالية', videos: [{title:'البورصة', id:'vid7', summary:'آلية عمل البورصة'}] }
                ]
            }
        ];

        // ============================================
        // 2. دوال العرض والتحكم
        // ============================================

        const views = {
            home: document.getElementById('homeView'),
            dept: document.getElementById('deptView'),
            player: document.getElementById('playerView')
        };

        // مسار التنقل للعودة للخلف بشكل صحيح
        let navigationHistory = 'home'; // 'home' or 'dept'

        window.onload = function() {
            renderGeneralSubjects();
            renderDepartments();
        };

        // رسم المواد العامة
        function renderGeneralSubjects() {
            const grid = document.getElementById('generalGrid');
            grid.innerHTML = generalSubjects.map(sub => `
                <div class="subject-chip" onclick="openPlayer('${sub.id}', 'general')">
                    <i class="fas ${sub.icon} subject-icon"></i>
                    <div class="subject-name">${sub.title}</div>
                </div>
            `).join('');
        }

        // رسم كروت الأقسام
        function renderDepartments() {
            const grid = document.getElementById('departmentsGrid');
            grid.innerHTML = departments.map(dept => `
                <div class="dept-card" onclick="openDepartment('${dept.id}')">
                    <i class="fas ${dept.icon} dept-icon"></i>
                    <h3 class="dept-title">${dept.name}</h3>
                    <p style="color:#666; margin-top:10px;">${dept.courses.length} كورسات متاحة</p>
                </div>
            `).join('');
        }

        // فتح صفحة القسم (عرض الكورسات)
        let currentDeptId = null;
        function openDepartment(deptId) {
            currentDeptId = deptId;
            const dept = departments.find(d => d.id === deptId);
            if(!dept) return;

            // إظهار واجهة القسم
            switchView('dept');
            document.getElementById('deptTitleDisplay').innerHTML = `<i class="fas ${dept.icon}"></i> ${dept.name}`;
            
            // رسم كورسات القسم
            const grid = document.getElementById('deptCoursesGrid');
            grid.innerHTML = dept.courses.map(course => `
                <div class="course-card-inner" onclick="openPlayer('${course.id}', 'dept')">
                    <h3 style="color:#003366; margin:0 0 10px;">${course.title}</h3>
                    <p style="color:#777; font-size:0.9rem;">اضغط للمشاهدة</p>
                </div>
            `).join('');
        }

        // فتح المشغل (سواء لمادة عامة أو كورس تخصص)
        let currentObject = null; // الكائن الحالي (مادة أو كورس)
        function openPlayer(id, type) {
            let data = null;

            if (type === 'general') {
                data = generalSubjects.find(s => s.id === id);
                navigationHistory = 'home'; // العودة للرئيسية
            } else {
                // البحث داخل الأقسام
                departments.forEach(d => {
                    const c = d.courses.find(c => c.id === id);
                    if(c) data = c;
                });
                navigationHistory = 'dept'; // العودة للقسم
            }

            if(!data) return;
            currentObject = data;

            switchView('player');
            document.getElementById('playerCourseTitle').innerText = data.title;
            renderPlaylist(data.videos);
            loadVideo(data.videos[0]);
        }

        function renderPlaylist(videos) {
            const list = document.getElementById('playlistItems');
            list.innerHTML = videos.map((vid, idx) => `
                <div class="playlist-item" onclick="loadVideoAtIndex(${idx})">
                    <span>${idx+1}. ${vid.title}</span>
                    <i class="far fa-play-circle"></i>
                </div>
            `).join('');
        }

        function loadVideoAtIndex(idx) {
            loadVideo(currentObject.videos[idx]);
        }

        function loadVideo(video) {
            document.getElementById('mainVideoPlayer').src = `https://www.youtube.com/embed/${video.id}?rel=0`; // ضع رابط فيديو حقيقي هنا
            document.getElementById('currentLessonTitle').innerText = video.title;
            document.getElementById('currentLessonSummary').innerText = video.summary;
        }

        // التنقل بين الواجهات
        function switchView(viewName) {
            Object.values(views).forEach(el => el.classList.add('hidden'));
            views[viewName].classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function goHome() {
            document.getElementById('mainVideoPlayer').src = "";
            switchView('home');
        }

        function goBackFromPlayer() {
            document.getElementById('mainVideoPlayer').src = "";
            if (navigationHistory === 'dept' && currentDeptId) {
                switchView('dept');
            } else {
                switchView('home');
            }
        }

        // --- البحث الشامل ---
        const searchInput = document.getElementById('searchInput');
        const suggestionBox = document.getElementById('suggestionBox');

        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase();
            suggestionBox.innerHTML = '';
            
            if (query.length < 1) {
                suggestionBox.classList.remove('show');
                return;
            }

            // البحث في المواد العامة
            const genMatches = generalSubjects.filter(s => s.title.includes(query));
            // البحث في كورسات الأقسام
            let deptMatches = [];
            departments.forEach(d => {
                d.courses.forEach(c => {
                    if(c.title.includes(query)) deptMatches.push(c);
                });
            });

            const allMatches = [...genMatches, ...deptMatches];

            if (allMatches.length > 0) {
                suggestionBox.classList.add('show');
                allMatches.forEach(match => {
                    const li = document.createElement('li');
                    li.className = 'suggestion-item';
                    li.innerText = match.title;
                    li.onclick = () => {
                        // تحديد هل هو عام أم خاص لفتح المشغل
                        const isGeneral = generalSubjects.some(g => g.id === match.id);
                        openPlayer(match.id, isGeneral ? 'general' : 'dept');
                        suggestionBox.classList.remove('show');
                        searchInput.value = '';
                    };
                    suggestionBox.appendChild(li);
                });
            } else {
                suggestionBox.classList.remove('show');
            }
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container')) {
                suggestionBox.classList.remove('show');
            }
        });

    </script>
</body>
</html>
